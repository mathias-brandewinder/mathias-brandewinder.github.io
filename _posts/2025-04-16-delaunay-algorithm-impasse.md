---
layout: post
title: Delaunay triangulation&#58; hitting an impasse
tags:
- F#
- Algorithms
- Geometry
---

During the recent weeks, I have been making slow but steady progress 
implementing [Delaunay triangulation][2] with the [Bowyer-Watson algorithm][1]. 
However, as I mentioned in the conclusion of my previous post, I spotted a bug, 
which I hoped would be an easy fix, but so far no such luck: it has me stumped. 
In this post, I will go over how I approached figuring out the problem, which 
is interesting in its own right. My hope is that by talking it through I 
might either get an idea, or perhaps someone else will spot what I am missing!  

Anyways, let's get into it. Per the [Wikipedia entry][2]:

>>>
a Delaunay triangulation [...] of a set of points in the plane subdivides their 
convex hull into triangles whose circumcircles do not contain any of the points; 
that is, each circumcircle has its generating points on its circumference, but 
all other points in the set are outside of it. This maximizes the size of the 
smallest angle in any of the triangles, and tends to avoid sliver triangles. 

The [Bowyer-Watson algorithm][1] seemed straightforward to implement, so that's 
what I did. For those interested, [my current code is here][3], and it mostly 
works. Starting from a list of 20 random points, I can generate a triangulation 
like so:  

``` fsharp
let points =
    let rng = Random 0
    List.init size (fun _ ->
        {
            X = rng.NextDouble() * 100.
            Y = rng.NextDouble() * 100.
        }
        )
points
|> BowyerWatson.delaunay
```

With a bit of tinkering, I can render the result using SVG:  

<svg width="400" height="400" viewbox="-1.7681101205610257 -1.78820137949111 105.76586706832326 106.14780995349763">
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 81.69079086822029,84.8051783092344 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="81.69079086822029,84.8051783092344 86.23701538249712,99.53470812157481 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 67.71811492169189,31.45917930242567 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 98.21512531406019,3.0366990729406003 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 54.68154342597422,8.1109949891041 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="69.99419837724147,52.62841426424143 76.80226893946634,55.81611914365372 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 69.99419837724147,52.62841426424143 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="18.712457417842213,45.33271852197718 20.60331540210327,55.88847946184151 3.039429291635486,38.10045068995117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="18.712457417842213,45.33271852197718 54.68154342597422,8.1109949891041 3.039429291635486,38.10045068995117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.717186572829814,98.85437791182397 3.039429291635486,38.10045068995117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.717186572829814,98.85437791182397 86.23701538249712,99.53470812157481 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="64.26974728902324,76.29635882391425 72.62432699679599,81.73253595909688 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.717186572829814,98.85437791182397 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 64.26974728902324,76.29635882391425 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>

This looks like what I would expect: all the points are connected in a mesh of 
triangles.

<!--more-->

However, if I take a subset of the points, like so:  

``` fsharp
points
|> List.truncate 9
|> BowyerWatson.delaunay
```

... I then get the following result:  

<svg width="400" height="400" viewbox="16.722724906505423 -1.78820137949111 85.37299090315263 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 98.21512531406019,3.0366990729406003" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>

This is still pretty, but it can't be right. From the Wikipedia entry:  

>>>
a Delaunay triangulation [...] of a set of points in the plane 
**subdivides their convex hull** into triangles

The result should be a convex hull, that is, the outer boundary should be 
convex. Or, stated differently, the outer boundary should never "bend inwards", 
and yet, we can see such a bend on the figure above, in the West to South-East 
boundary. What is going on here?  

My first assumption was of course Denial. Certainly, my code is correct, I must 
be hitting a weird edge case with that particular set of points. So I generated 
a list of Delaunay diagrams, taking more and more points:  

<svg width="400" height="400" viewbox="17.793367725235115 54.520298302881564 61.818848891099385 28.508058496987474">
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 20.60331540210327,55.88847946184151" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="17.103345842148805 42.34204989967032 76.99933031899823 41.26622349082783">
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 20.60331540210327,55.88847946184151" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.745732406501535 24.65234125948154 84.8668259032382 59.798299209120835">
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 20.60331540210327,55.88847946184151" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 76.80226893946634,55.81611914365372 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.745732406501535 24.65234125948154 84.8668259032382 59.798299209120835">
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 97.75497531413798,27.370445768987032 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.745732406501535 24.65234125948154 84.8668259032382 59.798299209120835">
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 97.75497531413798,27.370445768987032 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.722724906505423 -0.8980927713672133 85.37299090315263 86.5654205747719">
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 98.21512531406019,3.0366990729406003" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.722724906505423 -1.78820137949111 85.37299090315263 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 98.21512531406019,3.0366990729406003" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.722724906505423 -1.78820137949111 85.37299090315263 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 76.80226893946634,55.81611914365372 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.722724906505423 -1.78820137949111 85.37299090315263 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 76.80226893946634,55.81611914365372 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="86.23701538249712,99.53470812157481 90.60270660119258,44.217787331071584 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.67397029543015 -1.78820137949111 86.4455923468087 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 76.80226893946634,55.81611914365372 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="86.23701538249712,99.53470812157481 90.60270660119258,44.217787331071584 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.67397029543015 -1.78820137949111 86.4455923468087 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="86.23701538249712,99.53470812157481 90.60270660119258,44.217787331071584 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 72.62432699679599,81.73253595909688 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.67397029543015 -1.78820137949111 86.4455923468087 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 72.62432699679599,81.73253595909688 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 81.69079086822029,84.8051783092344 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="81.69079086822029,84.8051783092344 86.23701538249712,99.53470812157481 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="16.67397029543015 -1.78820137949111 86.4455923468087 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 72.62432699679599,81.73253595909688 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 81.69079086822029,84.8051783092344 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="81.69079086822029,84.8051783092344 86.23701538249712,99.53470812157481 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 67.71811492169189,31.45917930242567 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 98.21512531406019,3.0366990729406003 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="14.688569411956038 -1.78820137949111 88.52553612949585 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 72.62432699679599,81.73253595909688 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 81.69079086822029,84.8051783092344 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="81.69079086822029,84.8051783092344 86.23701538249712,99.53470812157481 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 67.71811492169189,31.45917930242567 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 98.21512531406019,3.0366990729406003 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 54.68154342597422,8.1109949891041 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="14.688569411956038 -1.78820137949111 88.52553612949585 106.14780995349763">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.190628476995332,46.73147003479836" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 72.62432699679599,81.73253595909688 63.26590728166788,46.95118784296847" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 72.62432699679599,81.73253595909688 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 81.69079086822029,84.8051783092344 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="81.69079086822029,84.8051783092344 86.23701538249712,99.53470812157481 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 67.71811492169189,31.45917930242567 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 98.21512531406019,3.0366990729406003 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 54.68154342597422,8.1109949891041 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 29.717186572829814,98.85437791182397" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 29.717186572829814,98.85437791182397" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="14.688569411956038 -1.78820137949111 88.52553612949585 106.14780995349763">
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 81.69079086822029,84.8051783092344 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="81.69079086822029,84.8051783092344 86.23701538249712,99.53470812157481 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 67.71811492169189,31.45917930242567 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 98.21512531406019,3.0366990729406003 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 54.68154342597422,8.1109949891041 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 29.717186572829814,98.85437791182397" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="69.99419837724147,52.62841426424143 76.80226893946634,55.81611914365372 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 69.99419837724147,52.62841426424143 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.717186572829814,98.85437791182397 72.62432699679599,81.73253595909688 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.717186572829814,98.85437791182397 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="-1.7681101205610257 -1.78820137949111 105.76586706832326 106.14780995349763">
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 81.69079086822029,84.8051783092344 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="81.69079086822029,84.8051783092344 86.23701538249712,99.53470812157481 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 67.71811492169189,31.45917930242567 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 98.21512531406019,3.0366990729406003 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 54.68154342597422,8.1109949891041 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 29.717186572829814,98.85437791182397" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="69.99419837724147,52.62841426424143 76.80226893946634,55.81611914365372 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 69.99419837724147,52.62841426424143 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.717186572829814,98.85437791182397 72.62432699679599,81.73253595909688 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.717186572829814,98.85437791182397 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="18.712457417842213,45.33271852197718 20.60331540210327,55.88847946184151 3.039429291635486,38.10045068995117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="18.712457417842213,45.33271852197718 54.68154342597422,8.1109949891041 3.039429291635486,38.10045068995117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.717186572829814,98.85437791182397 3.039429291635486,38.10045068995117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>
<svg width="400" height="400" viewbox="-1.7681101205610257 -1.78820137949111 105.76586706832326 106.14780995349763">
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 81.69079086822029,84.8051783092344" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="97.75497531413798,27.370445768987032 98.21512531406019,3.0366990729406003 99.19021753556571,3.2625198379450104" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 90.60270660119258,44.217787331071584 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 67.71811492169189,31.45917930242567 69.99419837724147,52.62841426424143" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="90.60270660119258,44.217787331071584 97.75497531413798,27.370445768987032 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 81.69079086822029,84.8051783092344 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="76.80226893946634,55.81611914365372 90.60270660119258,44.217787331071584 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="81.69079086822029,84.8051783092344 86.23701538249712,99.53470812157481 93.4018658909024,68.76202824933549" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 67.71811492169189,31.45917930242567 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="67.71811492169189,31.45917930242567 98.21512531406019,3.0366990729406003 54.68154342597422,8.1109949891041" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 54.68154342597422,8.1109949891041 18.712457417842213,45.33271852197718" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.190628476995332,46.73147003479836 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.190628476995332,46.73147003479836 63.26590728166788,46.95118784296847 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 76.80226893946634,55.81611914365372 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="69.99419837724147,52.62841426424143 76.80226893946634,55.81611914365372 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="63.26590728166788,46.95118784296847 69.99419837724147,52.62841426424143 64.26974728902324,76.29635882391425" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="18.712457417842213,45.33271852197718 20.60331540210327,55.88847946184151 3.039429291635486,38.10045068995117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="18.712457417842213,45.33271852197718 54.68154342597422,8.1109949891041 3.039429291635486,38.10045068995117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.717186572829814,98.85437791182397 3.039429291635486,38.10045068995117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="29.717186572829814,98.85437791182397 86.23701538249712,99.53470812157481 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="64.26974728902324,76.29635882391425 72.62432699679599,81.73253595909688 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 29.717186572829814,98.85437791182397 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="20.60331540210327,55.88847946184151 64.26974728902324,76.29635882391425 34.31418446559188,95.74551656644117" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>

This does unfortunately not look like a fluke. I can observe bends inwards 
occurring multiple times, in images 7, 8, 13.  

After Denial I switched straight to Acceptance: I must have made a bone-headed 
coding error somewhere. Fine, but... how do I even approach understanding what 
might be going wrong? The first problem occurs on image 7, and there are 
already 10 points involved, this is going to be a nightmare to work with.  

My first step was to try and shrink the problem to the smallest failing case I 
could. With a bit of tinkering and intuition, I ended up reproducing the issue 
with a much smaller setup:  

``` fsharp
let points =
    [ 0; 2; 4; 8 ]
    |> List.map (fun i -> points.[i])
points
|> BowyerWatson.delaunay
```

This involves only 4 points now, and the result is most definitely not a convex 
polygon:  

<svg width="400" height="400" viewbox="16.745732406501535 23.762232651357643 84.8668259032382 79.38068858784655">
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="0.2"/>
  <polygon points="72.62432699679599,81.73253595909688 97.75497531413798,27.370445768987032 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="0.2"/>
</svg>

Great. Now that we have a small test case, let's dig in. We'll run the 
triangulation before and after the step where things go off the rails, 
including the outer super-triangle for completeness:  

<svg width="500" height="500" viewbox="-68.12109349673665 -17.732218201380324 254.6004777097146 198.45172146961636">
  <circle cx="86.23701538249712" cy="99.53470812157481" r="2" />
  <polygon points="59.17914535812063,171.69897047416256 174.9066352261727,-8.711685407306852 72.62432699679599,81.73253595909688" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="-56.54834450993145,-8.711685407306852 59.17914535812063,171.69897047416256 20.60331540210327,55.88847946184151" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="59.17914535812063,171.69897047416256 72.62432699679599,81.73253595909688 20.60331540210327,55.88847946184151" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="-56.54834450993145,-8.711685407306852 174.9066352261727,-8.711685407306852 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="-56.54834450993145,-8.711685407306852 20.60331540210327,55.88847946184151 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="72.62432699679599,81.73253595909688 174.9066352261727,-8.711685407306852 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="1"/>
</svg>
<svg width="500" height="500" viewbox="-68.12109349673665 -17.732218201380324 254.6004777097146 198.45172146961636">
  <circle cx="86.23701538249712" cy="99.53470812157481" r="2" />
  <polygon points="-56.54834450993145,-8.711685407306852 59.17914535812063,171.69897047416256 20.60331540210327,55.88847946184151" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="59.17914535812063,171.69897047416256 72.62432699679599,81.73253595909688 20.60331540210327,55.88847946184151" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="-56.54834450993145,-8.711685407306852 174.9066352261727,-8.711685407306852 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="-56.54834450993145,-8.711685407306852 20.60331540210327,55.88847946184151 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 97.75497531413798,27.370445768987032" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="59.17914535812063,171.69897047416256 174.9066352261727,-8.711685407306852 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="59.17914535812063,171.69897047416256 72.62432699679599,81.73253595909688 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="97.75497531413798,27.370445768987032 174.9066352261727,-8.711685407306852 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="1"/>
  <polygon points="72.62432699679599,81.73253595909688 97.75497531413798,27.370445768987032 86.23701538249712,99.53470812157481" fill="lightyellow" stroke="black" stroke-width="1"/>
</svg>

Here we can see how, as we add a point in the South-East area, the 
triangulation gets properly adjusted in the North-East area, but not in the 
bottom section, where a bend inwards appears. Some of the triangles that should 
be recomputed are not.  

How does the algorithm decide if a triangle needs to be recomputed? Per the 
[Bowyer-Watson pseudo code][4],  

```
for each point in pointList do
    badTriangles := empty set
    for each triangle in triangulation do
        // first find all the triangles that are no longer valid due to the insertion
        **if point is inside circumcircle of triangle**
            add triangle to badTriangles
```

When a point is added, we take the existing triangles, and, if the point is 
inside the circumcircle of a triangle, we recompute it. Let's visualize these 
circles then:  

<svg width="500" height="500" viewbox="-386.4345976284119 -378.787617873126 814.6234155230543 794.6288569119026">
  <circle cx="86.23701538249712" cy="99.53470812157481" r="2" />
  <polygon points="59.17914535812063,171.69897047416256 174.9066352261727,-8.711685407306852 72.62432699679599,81.73253595909688" fill="none" stroke="black" stroke-width="1"/>
  <circle cx="224.48759089235577" cy="150.41587686229133" r="166.67288993305678" stroke-width="0.5" stroke="black" fill="none"/>
  <polygon points="-56.54834450993145,-8.711685407306852 59.17914535812063,171.69897047416256 20.60331540210327,55.88847946184151" fill="none" stroke="black" stroke-width="1"/>
  <circle cx="-145.0966849346064" cy="175.41216991820528" r="204.30957562457576" stroke-width="0.5" stroke="black" fill="none"/>
  <polygon points="59.17914535812063,171.69897047416256 72.62432699679599,81.73253595909688 20.60331540210327,55.88847946184151" fill="none" stroke="black" stroke-width="1"/>
  <circle cx="21.167756056061986" cy="120.03041005064765" r="64.14441404293183" stroke-width="0.5" stroke="black" fill="none"/>
  <polygon points="-56.54834450993145,-8.711685407306852 174.9066352261727,-8.711685407306852 97.75497531413798,27.370445768987032" fill="none" stroke="black" stroke-width="1"/>
  <circle cx="59.179145358120635" cy="-155.63811018439105" r="187.03001419273934" stroke-width="0.5" stroke="black" fill="none"/>
  <polygon points="-56.54834450993145,-8.711685407306852 20.60331540210327,55.88847946184151 97.75497531413798,27.370445768987032" fill="none" stroke="black" stroke-width="1"/>
  <circle cx="30.924645775862167" cy="-34.80924161759618" r="91.28311163456115" stroke-width="0.5" stroke="black" fill="none"/>
  <polygon points="72.62432699679599,81.73253595909688 174.9066352261727,-8.711685407306852 97.75497531413798,27.370445768987032" fill="none" stroke="black" stroke-width="1"/>
  <circle cx="177.42042678807022" cy="97.18817349256075" r="105.92969018659747" stroke-width="0.5" stroke="black" fill="none"/>
  <polygon points="20.60331540210327,55.88847946184151 72.62432699679599,81.73253595909688 97.75497531413798,27.370445768987032" fill="none" stroke="black" stroke-width="1"/>
  <circle cx="59.579409059124366" cy="42.7123215974735" r="41.1430068520475" stroke-width="0.5" stroke="black" fill="none"/>
</svg>

And this is where I hit an impasse. On this diagram, we can see the point we 
are adding to the triangulation. The triangle West of it must be recomputed to 
avoid creating the issue we observe, but its circumcircle, while coming close 
to our point, does not contain it. In other words, the algorithm concludes that 
this section of the triangulation is fine - when it is not.  

## Parting thoughts

So where does this leave me? I am genuinely stumped here. From what I can tell, 
my implementation is faithful to the pseudo-code. I can't see an obvious error, 
and yet, the result is clearly incorrect.  

My best guess at the moment is that either I missed a subtlety in the 
algorithm, or that perhaps there is an unspoken assumption / missing detail, 
perhaps around triangles that are connected to the corners of the outer 
super-triangle.  

At any rate, I am stuck. My next steps are first to sleep on it, and then 
possibly to see if the original source articles might help. In the meantime, 
hopefully you will have found something of interest in this hunt for a bug, 
and, if you happen to know what I am doing wrong, I would love to hear it :)

[1]: https://en.wikipedia.org/wiki/Bowyer%E2%80%93Watson_algorithm
[2]: https://en.wikipedia.org/wiki/Delaunay_triangulation
[3]: https://github.com/mathias-brandewinder/delaunay/blob/47782f318e92168264a87ab8f5d36387f3ff43bb/src/Delaunay/Core.fs#L27-L147
[4]: https://en.wikipedia.org/wiki/Bowyer%E2%80%93Watson_algorithm#Pseudocode